(function(n){"use strict";var i=n.fn.bootstrapTable.utils.sprintf,a=n.fn.bootstrapTable.utils.objectKeys,s=function(n){return n.get(n.length-1).options},v=function(n,t){for(var u=s(n),r=0;r<u.length;r++)u[r].value!==""&&(t.hasOwnProperty(u[r].value)?n.find(i("option[value='%s']",u[r].value)).show():n.find(i("option[value='%s']",u[r].value)).hide())},r=function(t,i,r){i=n.trim(i);t=n(t.get(t.length-1));y(t,i)||t.append(n("<option><\/option>").attr("value",i).text(n("<div />").html(r).text()))},u=function(t){var i=t.find("option:gt(0)");i.sort(function(t,i){return t=n(t).text().toLowerCase(),i=n(i).text().toLowerCase(),n.isNumeric(t)&&n.isNumeric(i)&&(t=parseFloat(t),i=parseFloat(i)),t>i?1:t<i?-1:0});t.find("option:gt(0)").remove();t.append(i)},y=function(n,t){for(var r=s(n),i=0;i<r.length;i++)if(r[i].value===t.toString())return!0;return!1},p=function(n){n.$tableHeader.css("height","77px")},f=function(n){var t=n.$header;return n.options.height&&(t=n.$tableHeader),t},e=function(n){var t="select, input";return n.options.height&&(t="table select, table input"),t},w=function(t){var i,r,u;return n.fn.bootstrapTable.utils.isIEBrowser()?n(t).is("input")?(i=0,"selectionStart"in t?i=t.selectionStart:"selection"in document&&(t.focus(),r=document.selection.createRange(),u=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),i=r.text.length-u),i):-1:-1},b=function(t,i){n.fn.bootstrapTable.utils.isIEBrowser()&&(t.setSelectionRange!==undefined?t.setSelectionRange(i,i):n(t).val(t.value))},h=function(t){var i=f(t),r=e(t);t.options.valuesFilterControl=[];i.find(r).each(function(){t.options.valuesFilterControl.push({field:n(this).closest("[data-field]").data("field"),value:n(this).val(),position:w(n(this).get(0))})})},o=function(t){var r=null,i=[],u=f(t),o=e(t);t.options.valuesFilterControl.length>0&&u.find(o).each(function(){r=n(this).closest("[data-field]").data("field");i=n.grep(t.options.valuesFilterControl,function(n){return n.field===r});i.length>0&&(n(this).val(i[0].value),b(n(this).get(0),i[0].position))})},k=function(){var t=[],i=document.cookie.match(/(?:bs.table.)(\w*)/g);if(i)return n.each(i,function(i,r){/./.test(r)&&(r=r.split(".").pop());n.inArray(r,t)===-1&&t.push(r)}),t},d=function(t){var i=t.data,h=t.pageTo<t.options.data.length?t.options.data.length:t.pageTo,f=function(n){return n.filterControl&&n.filterControl.toLowerCase()==="select"&&n.searchable},e=function(n){return n.filterData===undefined||n.filterData.toLowerCase()==="column"},o=function(n){return n&&n.length>0},s=t.options.pagination?t.options.sidePagination==="server"?t.pageTo:t.options.totalRows:t.pageTo;n.each(t.header.fields,function(h,l){var b=t.columns[n.fn.bootstrapTable.utils.getFieldIndex(t.columns,l)],a=n(".bootstrap-table-filter-control-"+c(b.field)),p,y,w,d,k;if(f(b)&&e(b)&&o(a)){for(a.get(a.length-1).options.length===0&&r(a,"",""),p={},y=0;y<s;y++)w=i[y][l],d=n.fn.bootstrapTable.utils.calculateObjectValue(t.header,t.header.formatters[h],[w,i[y],y],w),p[d]=w;for(k in p)r(a,p[k],k);u(a);t.options.hideUnusedSelectOptions&&v(a,p)}})},c=function(n){return String(n).replace(/(:|\.|\[|\]|,)/g,"\\$1")},l=function(t,f){var h=!1,s,o,e=0;if(n.each(t.columns,function(i,e){var w,p,y,l,a,v;if((s="hidden",o=[],e.visible)&&(e.filterControl?(o.push('<div class="filter-control">'),w=e.filterControl.toLowerCase(),e.searchable&&t.options.filterTemplate[w]&&(h=!0,s="visible",o.push(t.options.filterTemplate[w](t,e.field,s,e.filterControlPlaceholder)))):o.push('<div class="no-filter-control"><\/div>'),n.each(f.children().children(),function(t,i){return i=n(i),i.data("field")===e.field?(i.find(".fht-cell").append(o.join("")),!1):void 0}),e.filterData!==undefined&&e.filterData.toLowerCase()!=="column")){if(p=tt(nt,e.filterData.substring(0,e.filterData.indexOf(":"))),p!==null)y=e.filterData.substring(e.filterData.indexOf(":")+1,e.filterData.length),l=n(".bootstrap-table-filter-control-"+c(e.field)),r(l,"",""),p(y,l);else throw new SyntaxError('Error. You should use any of these allowed filter data methods: var, json, url. Use like this: var: {key: "value"}');switch(p){case"url":n.ajax({url:y,dataType:"json",success:function(n){for(var t in n)r(l,t,n[t]);u(l)}});break;case"var":a=window[y];for(v in a)r(l,v,a[v]);u(l);break;case"jso":a=JSON.parse(y);for(v in a)r(l,v,a[v]);u(l)}}}),h){f.off("keyup","input").on("keyup","input",function(n){clearTimeout(e);e=setTimeout(function(){t.onColumnSearch(n)},t.options.searchTimeOut)});f.off("change","select").on("change","select",function(n){clearTimeout(e);e=setTimeout(function(){t.onColumnSearch(n)},t.options.searchTimeOut)});f.off("mouseup","input").on("mouseup","input",function(i){var r=n(this),u=r.val();u!==""&&setTimeout(function(){var n=r.val();n===""&&(clearTimeout(e),e=setTimeout(function(){t.onColumnSearch(i)},t.options.searchTimeOut))},1)});f.find(".date-filter-control").length>0&&n.each(t.columns,function(t,r){if(r.filterControl!==undefined&&r.filterControl.toLowerCase()==="datepicker")f.find(".date-filter-control.bootstrap-table-filter-control-"+r.field).datepicker(r.filterDatepickerOptions).on("change",function(t){n(i(".%s",t.currentTarget.classList.toString().split(" ").join("."))).val(t.currentTarget.value);n(t.currentTarget).keyup()})})}else f.find(".filterControl").hide()},g=function(n){n=n===undefined?"left":n.toLowerCase();switch(n){case"left":return"ltr";case"right":return"rtl";case"auto":return"auto";default:return"ltr"}},nt={"var":function(n,t){var i=window[n];for(var f in i)r(t,f,i[f]);u(t)},url:function(t,i){n.ajax({url:t,dataType:"json",success:function(n){for(var t in n)r(i,t,n[t]);u(i)}})},json:function(n,t){var i=JSON.parse(n);for(var f in i)r(t,f,i[f]);u(t)}},tt=function(n,t){for(var r=Object.keys(n),i=0;i<r.length;i++)if(r[i]===t)return n[t];return null};n.extend(n.fn.bootstrapTable.defaults,{filterControl:!1,onColumnSearch:function(){return!1},filterShowClear:!1,alignmentSelectControlOptions:undefined,filterTemplate:{input:function(n,t,r,u){return i('<input type="text" class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s" placeholder="%s">',t,r,u)},select:function(n,t,r){return i('<select class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s" dir="%s"><\/select>',t,r,g(n.options.alignmentSelectControlOptions))},datepicker:function(n,t,r){return i('<input type="text" class="form-control date-filter-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s">',t,r)}},valuesFilterControl:[]});n.extend(n.fn.bootstrapTable.COLUMN_DEFAULTS,{filterControl:undefined,filterData:undefined,filterDatepickerOptions:undefined,filterStrictSearch:!1,filterStartsWithSearch:!1,filterControlPlaceholder:""});n.extend(n.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"});n.extend(n.fn.bootstrapTable.defaults.icons,{clear:"glyphicon-trash icon-clear"});n.extend(n.fn.bootstrapTable.locales,{formatClearFilters:function(){return"Clear Filters"}});n.extend(n.fn.bootstrapTable.defaults,n.fn.bootstrapTable.locales);var t=n.fn.bootstrapTable.Constructor,it=t.prototype.init,rt=t.prototype.initToolbar,ut=t.prototype.initHeader,ft=t.prototype.initBody,et=t.prototype.initSearch;t.prototype.init=function(){if(this.options.filterControl){var n=this;Object.keys||a();this.options.valuesFilterControl=[];this.$el.on("reset-view.bs.table",function(){n.options.height&&(n.$tableHeader.find("select").length>0||n.$tableHeader.find("input").length>0||l(n,n.$tableHeader))}).on("post-header.bs.table",function(){o(n)}).on("post-body.bs.table",function(){n.options.height&&p(n)}).on("column-switch.bs.table",function(){o(n)})}it.apply(this,Array.prototype.slice.apply(arguments))};t.prototype.initToolbar=function(){if(this.showToolbar=this.options.filterControl&&this.options.filterShowClear,rt.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&this.options.filterShowClear){var r=this.$toolbar.find(">.btn-group"),t=r.find(".filter-show-clear");if(!t.length){t=n(['<button class="btn btn-default filter-show-clear" ',i('type="button" title="%s">',this.options.formatClearFilters()),i('<i class="%s %s"><\/i> ',this.options.iconsPrefix,this.options.icons.clear),"<\/button>"].join("")).appendTo(r);t.off("click").on("click",n.proxy(this.clearFilterControl,this))}}};t.prototype.initHeader=function(){(ut.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl)&&l(this,this.$header)};t.prototype.initBody=function(){ft.apply(this,Array.prototype.slice.apply(arguments));d(this)};t.prototype.initSearch=function(){if(et.apply(this,Array.prototype.slice.apply(arguments)),this.options.sidePagination!=="server"){var t=this,i=n.isEmptyObject(this.filterColumnsPartial)?null:this.filterColumnsPartial;this.data=i?n.grep(this.data,function(r,u){for(var e in i){var o=t.columns[n.fn.bootstrapTable.utils.getFieldIndex(t.columns,e)],s=i[e].toLowerCase(),f=r[e];if(o&&o.searchFormatter&&(f=n.fn.bootstrapTable.utils.calculateObjectValue(t.header,t.header.formatters[n.inArray(e,t.header.fields)],[f,r,u],f)),o.filterStrictSearch){if(!(n.inArray(e,t.header.fields)!==-1&&(typeof f=="string"||typeof f=="number")&&f.toString().toLowerCase()===s.toString().toLowerCase()))return!1}else if(o.filterStartsWithSearch){if(!(n.inArray(e,t.header.fields)!==-1&&(typeof f=="string"||typeof f=="number")&&(f+"").toLowerCase().indexOf(s)===0))return!1}else if(!(n.inArray(e,t.header.fields)!==-1&&(typeof f=="string"||typeof f=="number")&&(f+"").toLowerCase().indexOf(s)!==-1))return!1}return!0}):this.data}};t.prototype.initColumnSearch=function(n){if(h(this),n){this.filterColumnsPartial=n;this.updatePagination();for(var t in n)this.trigger("column-search",t,n[t])}};t.prototype.onColumnSearch=function(t){if(!(n.inArray(t.keyCode,[37,38,39,40])>-1)){h(this);var i=n.trim(n(t.currentTarget).val()),r=n(t.currentTarget).closest("[data-field]").data("field");n.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={});i?this.filterColumnsPartial[r]=i:delete this.filterColumnsPartial[r];this.searchText+="randomText";this.options.pageNumber=1;this.onSearch(t);this.trigger("column-search",r,i)}};t.prototype.clearFilterControl=function(){var c;if(this.options.filterControl&&this.options.filterShowClear){var t=this,s=k(),h=f(t),r=h.closest("table"),u=h.find(e(t)),a=t.$toolbar.find(".search input"),l=0;if(n.each(t.options.valuesFilterControl,function(n,t){t.value=""}),o(t),u.length>0)this.filterColumnsPartial={},n(u[0]).trigger(u[0].tagName==="INPUT"?"keyup":"change");else return;if(a.length>0&&t.resetSearch(),(t.options.sortName!==r.data("sortName")||t.options.sortOrder!==r.data("sortOrder"))&&(c=h.find(i('[data-field="%s"]',n(u[0]).closest("table").data("sortName"))),c.length>0)){t.onSort(r.data("sortName"),r.data("sortName"));n(c).find(".sortable").trigger("click")}clearTimeout(l);l=setTimeout(function(){s&&s.length>0&&n.each(s,function(n,i){t.deleteCookie!==undefined&&t.deleteCookie(i)})},t.options.searchTimeOut)}}})(jQuery);